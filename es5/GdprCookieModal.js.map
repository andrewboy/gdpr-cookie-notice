{"version":3,"sources":["../src/GdprCookieModal.js"],"names":["gdprCookieManager","_manager","_locale","modal","settings","statement","save","category","essential","title","desc","always_on","performance","analytics","marketing","_pluginPrefix","_isModalLoaded","_isCategoriesCheckedByDefault","_statementUrl","document","body","insertAdjacentHTML","getTemplateHtml","_getModalTemplate","categoryList","querySelector","innerHTML","_getCategoryTemplate","Object","assign","prefix","checked","input","label","classList","add","remove","catId","categories","setModalEventListeners","build","documentElement","closeButton","querySelectorAll","statementButton","categoryTitles","saveButton","addEventListener","e","hide","preventDefault","window","open","i","length","currentTarget","parentNode","toggle","setTimeout","categorySettings","getElementById","setEvent","template","data","replace","j"],"mappings":"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","file":"GdprCookieModal.js","sourcesContent":["import './sass/_variables.scss'\r\nimport './sass/modal/_modal.scss'\r\n\r\nexport default class {\r\n  constructor (gdprCookieManager) {\r\n    this._manager = gdprCookieManager\r\n    this._locale = {\r\n      modal: {\r\n        settings: 'Süti beállítások',\r\n        statement: 'Süti nyilatkozatunk',\r\n        save: 'Mentés'\r\n      },\r\n      category: {\r\n        essential: {\r\n          title: 'Szükséges sütik',\r\n          desc: 'Ezek a weboldal megfelelő megjelenéséhez szükséges sütik, amelyek nélkül nem működne a weboldal.',\r\n          always_on: 'Mindig betölt'\r\n        },\r\n        performance: {\r\n          title: 'Teljesítmény sütik',\r\n          desc: `Ezek a sütik kiegészítő funkciókat támogatnak az oldalon, például eltárolja, hogy milyen nyelven böngészi \r\n          a weboldalt. Ezek nélkül nem biztos, hogy minden megfelelően fog működni.`\r\n        },\r\n        analytics: {\r\n          title: 'Statisztika sütik',\r\n          desc: `Ezeket azért használjuk, hogy tájékozódni tudjunk arról, mikor, hányan és hogyan használják a \r\n          weboldalunkat. Ezekkel az adatokkal tudjuk később optimalizálni a weboldalunkat a megfelelő felhasználói \r\n          élményért.`\r\n        },\r\n        marketing: {\r\n          title: 'Marketing sütik',\r\n          desc: 'Ezek a sütik segítenek nekünk a hirdetések kezelésében, célzásában.'\r\n        }\r\n      }\r\n    }\r\n    this._pluginPrefix = 'gdpr-cookie-notice'\r\n    this._isModalLoaded = false\r\n    this._isCategoriesCheckedByDefault = false\r\n    this._statementUrl = 'https://index.hu/'\r\n  }\r\n\r\n  build () {\r\n    if (this._isModalLoaded) {\r\n      return\r\n    }\r\n\r\n    // Append modal into body\r\n    document.body.insertAdjacentHTML('beforeend', this.getTemplateHtml(this._getModalTemplate(), this._locale.modal))\r\n\r\n    // Get empty category list\r\n    let categoryList = document.querySelector('.' + this._pluginPrefix + '-modal-cookies')\r\n\r\n    //Load essential cookies\r\n    categoryList.innerHTML += this.getTemplateHtml(\r\n      this._getCategoryTemplate(),\r\n      Object.assign(\r\n        {},\r\n        this._locale.category.essential,\r\n        {\r\n          prefix: 'cookie_essential',\r\n          checked: 'checked=\"checked\"'\r\n        }\r\n      )\r\n    )\r\n    let input = document.querySelector('.' + this._pluginPrefix + '-modal-cookie-input')\r\n    let label = document.querySelector('.' + this._pluginPrefix + '-modal-cookie-input-switch')\r\n    label.innerHTML = this._locale.category.essential.always_on\r\n    label.classList.add(this._pluginPrefix + '-modal-cookie-state')\r\n    label.classList.remove(this._pluginPrefix + '-modal-cookie-input-switch')\r\n    input.remove()\r\n\r\n    for (let catId in this._manager.categories) {\r\n      categoryList.innerHTML += this.getTemplateHtml(\r\n        this._getCategoryTemplate(),\r\n        Object.assign(\r\n          {},\r\n          this._locale.category[catId],\r\n          {\r\n            prefix: 'cookie_' + catId,\r\n            // checked: this._isCategoriesCheckedByDefault || (this._gdprCookie.isExists() && this._gdprCookie.get()[catId])\r\n            checked: true\r\n              ? 'checked=\"checked\"'\r\n              : ''\r\n          }\r\n        )\r\n      )\r\n    }\r\n\r\n    // Load click functions\r\n    this.setModalEventListeners()\r\n\r\n    // Make sure modal is only loaded once\r\n    this._isModalLoaded = true\r\n  }\r\n\r\n  show () {\r\n    this.build()\r\n    document.documentElement.classList.add(this._pluginPrefix + '-show-modal')\r\n  }\r\n\r\n  hide () {\r\n    document.documentElement.classList.remove(this._pluginPrefix + '-show-modal')\r\n  }\r\n\r\n  // Click functions in the modal\r\n  setModalEventListeners () {\r\n    let closeButton = document.querySelectorAll('.' + this._pluginPrefix + '-modal-close')[0]\r\n    let statementButton = document.querySelectorAll('.' + this._pluginPrefix + '-modal-footer-item-statement')[0]\r\n    let categoryTitles = document.querySelectorAll('.' + this._pluginPrefix + '-modal-cookie-title')\r\n    let saveButton = document.querySelectorAll('.' + this._pluginPrefix + '-modal-footer-item-save')[0]\r\n\r\n    closeButton.addEventListener('click', (e) => {\r\n      this.hide()\r\n      return false\r\n    })\r\n\r\n    statementButton.addEventListener('click', (e) => {\r\n      e.preventDefault()\r\n      window.open(\r\n        this._statementUrl,\r\n        '_blank'\r\n      )\r\n    })\r\n\r\n    for (let i = 0; i < categoryTitles.length; i++) {\r\n      categoryTitles[i].addEventListener('click', (e) => {\r\n        e.currentTarget.parentNode.parentNode.classList.toggle('open')\r\n        return false\r\n      })\r\n    }\r\n\r\n    saveButton.addEventListener('click', (e) => {\r\n      e.preventDefault()\r\n      saveButton.classList.add('saved')\r\n      window.setTimeout(() => {\r\n        saveButton.classList.remove('saved')\r\n      }, 1000)\r\n\r\n      let categorySettings = {}\r\n\r\n      for (let catId in this._manager.categories) {\r\n        categorySettings[catId] = document.getElementById(this._pluginPrefix + '-cookie_' + catId).checked\r\n      }\r\n\r\n      this._manager.setEvent(\r\n        'accept_categories',\r\n        {\r\n          performance: !!this._manager.categories.performance && document.getElementById(this._pluginPrefix + '-cookie_performance').checked,\r\n          analytics: !!this._manager.categories.analytics && document.getElementById(this._pluginPrefix + '-cookie_analytics').checked,\r\n          marketing: !!this._manager.categories.marketing && document.getElementById(this._pluginPrefix + '-cookie_marketing').checked\r\n        }\r\n      )\r\n      window.setTimeout(() => {\r\n        this.hide()\r\n      }, 1000)\r\n    })\r\n  }\r\n\r\n  _getModalTemplate () {\r\n    return `<div class=\"gdpr-cookie-notice-modal\">\r\n      <div class=\"gdpr-cookie-notice-modal-content\">\r\n        <div class=\"gdpr-cookie-notice-modal-header\">\r\n          <h2 class=\"gdpr-cookie-notice-modal-title\">{{settings}}</h2>\r\n          <button type=\"button\" class=\"gdpr-cookie-notice-modal-close\"></button>\r\n        </div>\r\n        <ul class=\"gdpr-cookie-notice-modal-cookies\"></ul>\r\n        <div class=\"gdpr-cookie-notice-modal-footer\">\r\n          <a href=\"#\" class=\"gdpr-cookie-notice-modal-footer-item gdpr-cookie-notice-modal-footer-item-statement\">{{statement}}</a>\r\n          <a href=\"#\" class=\"gdpr-cookie-notice-modal-footer-item gdpr-cookie-notice-modal-footer-item-save gdpr-cookie-notice-modal-footer-item-btn\">\r\n              <span>{{save}}</span>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </div>`\r\n  }\r\n\r\n  _getCategoryTemplate () {\r\n    return `<li class=\"gdpr-cookie-notice-modal-cookie\">\r\n    <div class=\"gdpr-cookie-notice-modal-cookie-row\">\r\n      <h3 class=\"gdpr-cookie-notice-modal-cookie-title\">{{title}}</h3>\r\n      <input type=\"checkbox\" name=\"gdpr-cookie-notice-{{prefix}}\" id=\"gdpr-cookie-notice-{{prefix}}\" class=\"gdpr-cookie-notice-modal-cookie-input\" {{checked}}>\r\n      <label class=\"gdpr-cookie-notice-modal-cookie-input-switch\" for=\"gdpr-cookie-notice-{{prefix}}\"></label>\r\n    </div>\r\n    <p class=\"gdpr-cookie-notice-modal-cookie-info\">{{desc}}</p>\r\n    </li>`\r\n  }\r\n\r\n  //string, object\r\n  getTemplateHtml (template, data) {\r\n    if (typeof template === 'string' && (data instanceof Object)) {\r\n      return template.replace(/{{([^}]+)}}/g, function (i, j) {\r\n        if (data[j]) {\r\n          return data[j]\r\n        } else {\r\n          return i\r\n        }\r\n      })\r\n    } else {\r\n      return false\r\n    }\r\n  }\r\n}"]}