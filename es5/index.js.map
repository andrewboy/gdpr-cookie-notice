{"version":3,"sources":["../src/index.js"],"names":["locales","GdprCookieNotice","options","console","log","_categories","categories","_namespace","namespace","_expiration","expiration","_domain","domain","window","location","hostname","_pluginPrefix","pluginPrefix","_locale","locale","_timeout","timeout","_statementUrl","statementUrl","_isCategoriesCheckedByDefault","categoriesCheckedByDefault","destroy","_gdprCookie","GdprCookie","_notice","GdprCookieNoticePopup","_modal","GdprCookieModal","isExists","show","_fireCookieEnvabledEvent","_setModalShowButton","globalSettingsButtons","document","querySelectorAll","i","addEventListener","e","preventDefault","_gdprCookiesEnabledEvt","CustomEvent","detail","get","dispatchEvent","evt","data","acceptAllCategories","acceptCategories","performance","analytics","marketing","Error","isPerformanceAccepted","isAnalyticsAccepted","isMarketingAccepted","set","isNecessaryAccepted","hide","notice","modal","isCategoriesCheckedByDefault"],"mappings":"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","file":"index.js","sourcesContent":["import { default as template } from './template'\r\nimport * as locales from './locales'\r\n// import './sass/gdpr-cookie-notice.scss'\r\n// import \"sass/modal/_variables.scss\";\r\n// import \"sass/notice2/_variables.scss\";\r\n\r\nimport GdprCookie from './GdprCookie'\r\nimport GdprCookieNoticePopup from './GdprCookieNoticePopup'\r\nimport GdprCookieModal from './GdprCookieModal'\r\n\r\n// GdprCookieNotice =======================================================\r\n\r\nclass GdprCookieNotice {\r\n  constructor (options) {\r\n    console.log('GdprCookieNotice:constructor')\r\n    this._categories = options.categories ? options.categories : []\r\n    // this._implicit = options.implicit ? options.implicit : false\r\n    // this._cookiesAccepted = false\r\n    //COOKIE\r\n    this._namespace = options.namespace ? options.namespace : 'gdprcookienotice'\r\n    this._expiration = options.expiration ? options.expiration : 30\r\n    this._domain = options.domain ? options.domain : window.location.hostname\r\n\r\n    //BOXES ==============\r\n    this._pluginPrefix = options.pluginPrefix ? options.pluginPrefix : 'gdpr-cookie-notice'\r\n    this._locale = options.locale ? options.locale : 'hu'\r\n    //NOTICE\r\n    this._timeout = options.timeout ? options.timeout : 500\r\n    this._statementUrl = options.statementUrl ? options.statementUrl : ''\r\n    //MODAL\r\n    this._isCategoriesCheckedByDefault = options.categoriesCheckedByDefault ? options.categoriesCheckedByDefault : false\r\n  }\r\n\r\n  run () {\r\n    this.destroy()\r\n    //cookie\r\n    this._gdprCookie = new GdprCookie(this._namespace, this._expiration, this._domain)\r\n    //notice\r\n    this._notice = new GdprCookieNoticePopup(\r\n      this,\r\n      this._pluginPrefix,\r\n      locales[this._locale]['notice'],\r\n      this._timeout,\r\n      this._statementUrl\r\n    )\r\n    //modal\r\n    this._modal = new GdprCookieModal(\r\n      this,\r\n      this._pluginPrefix,\r\n      locales[this._locale]['modal'],\r\n      this._isCategoriesCheckedByDefault\r\n    )\r\n\r\n    if (!this._gdprCookie.isExists()) {\r\n      this._notice.show()\r\n\r\n      // if (this._implicit) {\r\n      //   this.acceptOnScroll()\r\n      // }\r\n    } else {\r\n      //   this.deleteCookies(this.getCurrentCookieSelection())\r\n      this._fireCookieEnvabledEvent()\r\n    }\r\n\r\n    this._setModalShowButton()\r\n  }\r\n\r\n  destroy () {\r\n    if (this._notice) {\r\n      this._notice.destroy()\r\n    }\r\n\r\n    if (this._modal) {\r\n      this._modal.destroy()\r\n    }\r\n  }\r\n\r\n  _setModalShowButton () {\r\n    let globalSettingsButtons = document.querySelectorAll('.' + this._pluginPrefix + '-settings-button')\r\n\r\n    if (globalSettingsButtons) {\r\n      for (let i in globalSettingsButtons) {\r\n        console.log(i, globalSettingsButtons[i])\r\n        globalSettingsButtons[i].addEventListener('click', (e) => {\r\n          e.preventDefault()\r\n          this._modal.show()\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  _fireCookieEnvabledEvent () {\r\n    this._gdprCookiesEnabledEvt = new CustomEvent('gdprCookiesEnabled', {detail: this._gdprCookie.get()})\r\n    document.dispatchEvent(this._gdprCookiesEnabledEvt)\r\n  }\r\n\r\n  setEvent (evt, data) {\r\n    switch (evt) {\r\n      case 'accept_all_category':\r\n        this.acceptAllCategories()\r\n        break\r\n\r\n      case 'accept_categories':\r\n        this.acceptCategories(data.performance, data.analytics, data.marketing)\r\n        break\r\n\r\n      case 'show_modal':\r\n        this._modal.show()\r\n        break\r\n\r\n      default:\r\n        throw new Error('Event type not supported')\r\n    }\r\n  }\r\n\r\n  acceptAllCategories () {\r\n    this.acceptCategories(\r\n      !!this._categories.performance,\r\n      !!this._categories.analytics,\r\n      !!this._categories.marketing,\r\n    )\r\n  }\r\n\r\n  //COOKIE =============================================================================================================\r\n\r\n  // deleteCookies (savedCookies) {\r\n  //   for (let i in this._categories) {\r\n  //     if (Object.keys(savedCookies).indexOf(i) >= 0 || !savedCookies[i]) {\r\n  //       Cookies.remove(i)\r\n  //     }\r\n  //   }\r\n  //\r\n  //   if (!savedCookies) {\r\n  //     this.showNotice()\r\n  //   } else {\r\n  //     this.hideNotice()\r\n  //   }\r\n  // }\r\n\r\n  acceptCategories (isPerformanceAccepted, isAnalyticsAccepted, isMarketingAccepted) {\r\n    console.log('acceptCategories', isPerformanceAccepted, isAnalyticsAccepted, isMarketingAccepted)\r\n    // Load marketing scripts that only works when cookies are accepted\r\n    this._gdprCookie.set(\r\n      true,\r\n      isPerformanceAccepted,\r\n      isAnalyticsAccepted,\r\n      isMarketingAccepted\r\n    )\r\n    this._fireCookieEnvabledEvent()\r\n\r\n    if (this._gdprCookie.isExists() && this._gdprCookie.isNecessaryAccepted()) {\r\n      this._notice.hide()\r\n    } else {\r\n      this._notice.show()\r\n    }\r\n  }\r\n\r\n  //GETTER - SETTER ====================================================================================================\r\n\r\n  get notice() {\r\n    return this._notice\r\n  }\r\n\r\n  set notice (notice) {\r\n    this._notice = notice\r\n  }\r\n\r\n  get modal () {\r\n    return this._modal\r\n  }\r\n\r\n  set modal (modal) {\r\n    this._modal = modal\r\n  }\r\n\r\n  set statementUrl (statementUrl) {\r\n    this._statementUrl = statementUrl\r\n  }\r\n\r\n  get statementUrl () {\r\n    return this._statementUrl\r\n  }\r\n\r\n  // set implicit (isImplicit) {\r\n  //   this._implicit = isImplicit\r\n  // }\r\n  //\r\n  // get implicit () {\r\n  //   return this._implicit\r\n  // }\r\n\r\n  // set cookiesAccepted (isAccepted) {\r\n  //   this._cookiesAccepted = isAccepted\r\n  // }\r\n  //\r\n  // get cookiesAccepted () {\r\n  //   return this._cookiesAccepted\r\n  // }\r\n\r\n  set categories (categories) {\r\n    this._categories = categories\r\n  }\r\n\r\n  get categories () {\r\n    return this._categories\r\n  }\r\n\r\n  set locale (locale) {\r\n    this._locale = locale\r\n  }\r\n\r\n  get locale () {\r\n    return this._locale\r\n  }\r\n\r\n  set timeout (timeout) {\r\n    this._timeout = timeout\r\n  }\r\n\r\n  get timeout () {\r\n    return this._timeout\r\n  }\r\n\r\n  set domain (domain) {\r\n    this._domain = domain\r\n  }\r\n\r\n  get domain () {\r\n    return this._domain\r\n  }\r\n\r\n  set expiration (expiration) {\r\n    this._expiration = expiration\r\n  }\r\n\r\n  get expiration () {\r\n    return this._expiration\r\n  }\r\n\r\n  set isCategoriesCheckedByDefault (isCategoriesCheckedByDefault) {\r\n    this._isCategoriesCheckedByDefault = isCategoriesCheckedByDefault\r\n  }\r\n\r\n  get isCategoriesCheckedByDefault () {\r\n    return this._isCategoriesCheckedByDefault\r\n  }\r\n\r\n  set namespace (namespace) {\r\n    this._namespace = namespace\r\n  }\r\n\r\n  get namespace () {\r\n    return this._namespace\r\n  }\r\n\r\n  set pluginPrefix (pluginPrefix) {\r\n    this._pluginPrefix = pluginPrefix\r\n  }\r\n\r\n  get pluginPrefix () {\r\n    return this._pluginPrefix\r\n  }\r\n}\r\n\r\nexport default {GdprCookieNotice}"]}