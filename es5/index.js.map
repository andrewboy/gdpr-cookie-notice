{"version":3,"sources":["../src/index.js"],"names":["locales","GdprCookieNotice","options","console","log","load","GdprCookieNoticePopup","_opts","pluginPrefix","locale","timeout","statementUrl","GdprCookieModal","isCategoriesCheckedByDefault","destroy","Object","assign","categories","implicit","namespace","expiration","domain","window","location","hostname","isCategoriesAcceptedByDefault","_gdprCookie","GdprCookie","_notice","_getNotice","_modal","_getModal","isExists","show","_fireCookieEnvabledEvent","_setModalShowButton","globalSettingsButtons","document","querySelectorAll","i","addEventListener","e","preventDefault","_gdprCookiesEnabledEvt","CustomEvent","detail","get","dispatchEvent","evt","data","acceptAllCategories","acceptCategories","performance","analytics","marketing","Error","isPerformanceAccepted","isAnalyticsAccepted","isMarketingAccepted","set","isNecessaryAccepted","hide"],"mappings":";;;;;;qjBAAA;;AAEA;AACA;AACA;;AAHA;;IAAYA,O;;AAKZ;;;;AACA;;;;AACA;;;;;;;;;;AAEA;;IAEMC,gB;AACJ,4BAAaC,OAAb,EAAsB;AAAA;;AACpBC,YAAQC,GAAR,CAAY,8BAAZ;AACA,SAAKC,IAAL,CAAUH,OAAV;AACD;;;;iCAEa;AACZ,aAAO,IAAII,+BAAJ,CACL,IADK,EAEL,KAAKC,KAAL,CAAWC,YAFN,EAGLR,QAAQ,KAAKO,KAAL,CAAWE,MAAnB,EAA2B,QAA3B,CAHK,EAIL,KAAKF,KAAL,CAAWG,OAJN,EAKL,KAAKH,KAAL,CAAWI,YALN,CAAP;AAOD;;;gCAEY;AACX,aAAO,IAAIC,yBAAJ,CACL,IADK,EAEL,KAAKL,KAAL,CAAWC,YAFN,EAGLR,QAAQ,KAAKO,KAAL,CAAWE,MAAnB,EAA2B,OAA3B,CAHK,EAIL,KAAKF,KAAL,CAAWM,4BAJN,CAAP;AAMD;;;yBAEKX,O,EAAS;AACb;AACA,WAAKY,OAAL;;AAEA;AACA,WAAKP,KAAL,GAAaQ,OAAOC,MAAP,CAAc,EAAd,EAAkB;AAC7BC,oBAAY,EADiB;AAE7BC,kBAAU,KAFmB;AAG7B;AACAC,mBAAW,kBAJkB;AAK7BC,oBAAY,EALiB;AAM7BC,gBAAQC,OAAOC,QAAP,CAAgBC,QANK;AAO7B;AACAhB,sBAAc,oBARe;AAS7BC,gBAAQ,IATqB;AAU7B;AACAC,iBAAS,GAXoB;AAY7BC,sBAAc,EAZe;AAa7B;AACAc,uCAA+B;AAdF,OAAlB,EAeVvB,OAfU,CAAb;;AAiBA;AACA,WAAKwB,WAAL,GAAmB,IAAIC,oBAAJ,CAAe,KAAKpB,KAAL,CAAWY,SAA1B,EAAqC,KAAKZ,KAAL,CAAWa,UAAhD,EAA4D,KAAKb,KAAL,CAAWc,MAAvE,CAAnB;AACA;AACA,WAAKO,OAAL,GAAe,KAAKC,UAAL,EAAf;AACA;AACA,WAAKC,MAAL,GAAc,KAAKC,SAAL,EAAd;;AAEA,UAAI,CAAC,KAAKL,WAAL,CAAiBM,QAAjB,EAAL,EAAkC;AAChC,aAAKJ,OAAL,CAAaK,IAAb;;AAEA;AACA;AACA;AACD,OAND,MAMO;AACL;AACA,aAAKC,wBAAL;AACD;;AAED,WAAKC,mBAAL;AACD;;;8BAEU;AACT,UAAI,KAAKP,OAAT,EAAkB;AAChB,aAAKA,OAAL,CAAad,OAAb;AACD;;AAED,UAAI,KAAKgB,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYhB,OAAZ;AACD;AACF;;;0CAEsB;AAAA;;AACrB,UAAIsB,wBAAwBC,SAASC,gBAAT,CAA0B,MAAM,KAAK/B,KAAL,CAAWC,YAAjB,GAAgC,kBAA1D,CAA5B;;AAEA,UAAI4B,qBAAJ,EAA2B;AACzB,aAAK,IAAIG,CAAT,IAAcH,qBAAd,EAAqC;AACnCjC,kBAAQC,GAAR,CAAYmC,CAAZ,EAAeH,sBAAsBG,CAAtB,CAAf;AACAH,gCAAsBG,CAAtB,EAAyBC,gBAAzB,CAA0C,OAA1C,EAAmD,UAACC,CAAD,EAAO;AACxDA,cAAEC,cAAF;AACA,kBAAKZ,MAAL,CAAYG,IAAZ;AACD,WAHD;AAID;AACF;AACF;;;+CAE2B;AAC1B,WAAKU,sBAAL,GAA8B,IAAIC,WAAJ,CAAgB,oBAAhB,EAAsC,EAACC,QAAQ,KAAKnB,WAAL,CAAiBoB,GAAjB,EAAT,EAAtC,CAA9B;AACAT,eAASU,aAAT,CAAuB,KAAKJ,sBAA5B;AACD;;;6BAESK,G,EAAKC,I,EAAM;AACnB,cAAQD,GAAR;AACE,aAAK,qBAAL;AACE,eAAKE,mBAAL;AACA;;AAEF,aAAK,mBAAL;AACE,eAAKC,gBAAL,CAAsBF,KAAKG,WAA3B,EAAwCH,KAAKI,SAA7C,EAAwDJ,KAAKK,SAA7D;AACA;;AAEF,aAAK,YAAL;AACE,eAAKxB,MAAL,CAAYG,IAAZ;AACA;;AAEF;AACE,gBAAM,IAAIsB,KAAJ,CAAU,0BAAV,CAAN;AAdJ;AAgBD;;;0CAEsB;AACrB,WAAKJ,gBAAL,CACE,CAAC,CAAC,KAAK5C,KAAL,CAAWU,UAAX,CAAsBmC,WAD1B,EAEE,CAAC,CAAC,KAAK7C,KAAL,CAAWU,UAAX,CAAsBoC,SAF1B,EAGE,CAAC,CAAC,KAAK9C,KAAL,CAAWU,UAAX,CAAsBqC,SAH1B;AAKD;;AAED;;;;qCAEkBE,qB,EAAuBC,mB,EAAqBC,mB,EAAqB;AACjFvD,cAAQC,GAAR,CAAY,kBAAZ,EAAgCoD,qBAAhC,EAAuDC,mBAAvD,EAA4EC,mBAA5E;AACA;AACA,WAAKhC,WAAL,CAAiBiC,GAAjB,CACE,IADF,EAEEH,qBAFF,EAGEC,mBAHF,EAIEC,mBAJF;AAMA,WAAKxB,wBAAL;;AAEA,UAAI,KAAKR,WAAL,CAAiBM,QAAjB,MAA+B,KAAKN,WAAL,CAAiBkC,mBAAjB,EAAnC,EAA2E;AACzE,aAAKhC,OAAL,CAAaiC,IAAb;AACD,OAFD,MAEO;AACL,aAAKjC,OAAL,CAAaK,IAAb;AACD;AACF;;;;;;kBAGY,EAAChC,kCAAD,E","file":"index.js","sourcesContent":["// import { default as template } from './template'\r\nimport * as locales from './locales'\r\n// import './sass/gdpr-cookie-notice.scss'\r\n// import \"sass/modal/_variables.scss\";\r\n// import \"sass/notice2/_variables.scss\";\r\n\r\nimport GdprCookie from './GdprCookie'\r\nimport GdprCookieNoticePopup from './GdprCookieNoticePopup'\r\nimport GdprCookieModal from './GdprCookieModal'\r\n\r\n// GdprCookieNotice =======================================================\r\n\r\nclass GdprCookieNotice {\r\n  constructor (options) {\r\n    console.log('GdprCookieNotice:constructor')\r\n    this.load(options)\r\n  }\r\n\r\n  _getNotice () {\r\n    return new GdprCookieNoticePopup(\r\n      this,\r\n      this._opts.pluginPrefix,\r\n      locales[this._opts.locale]['notice'],\r\n      this._opts.timeout,\r\n      this._opts.statementUrl\r\n    )\r\n  }\r\n\r\n  _getModal () {\r\n    return new GdprCookieModal(\r\n      this,\r\n      this._opts.pluginPrefix,\r\n      locales[this._opts.locale]['modal'],\r\n      this._opts.isCategoriesCheckedByDefault\r\n    )\r\n  }\r\n\r\n  load (options) {\r\n    //remove actual\r\n    this.destroy()\r\n\r\n    //reset options\r\n    this._opts = Object.assign({}, {\r\n      categories: {},\r\n      implicit: false,\r\n      //cookie\r\n      namespace: 'gdprcookienotice',\r\n      expiration: 30,\r\n      domain: window.location.hostname,\r\n      //boxes\r\n      pluginPrefix: 'gdpr-cookie-notice',\r\n      locale: 'hu',\r\n      //notice\r\n      timeout: 500,\r\n      statementUrl: '',\r\n      //modal\r\n      isCategoriesAcceptedByDefault: false\r\n    }, options)\r\n\r\n    //cookie\r\n    this._gdprCookie = new GdprCookie(this._opts.namespace, this._opts.expiration, this._opts.domain)\r\n    //notice\r\n    this._notice = this._getNotice()\r\n    //modal\r\n    this._modal = this._getModal()\r\n\r\n    if (!this._gdprCookie.isExists()) {\r\n      this._notice.show()\r\n\r\n      // if (this._implicit) {\r\n      //   this.acceptOnScroll()\r\n      // }\r\n    } else {\r\n      //   this.deleteCookies(this.getCurrentCookieSelection())\r\n      this._fireCookieEnvabledEvent()\r\n    }\r\n\r\n    this._setModalShowButton()\r\n  }\r\n\r\n  destroy () {\r\n    if (this._notice) {\r\n      this._notice.destroy()\r\n    }\r\n\r\n    if (this._modal) {\r\n      this._modal.destroy()\r\n    }\r\n  }\r\n\r\n  _setModalShowButton () {\r\n    let globalSettingsButtons = document.querySelectorAll('.' + this._opts.pluginPrefix + '-settings-button')\r\n\r\n    if (globalSettingsButtons) {\r\n      for (let i in globalSettingsButtons) {\r\n        console.log(i, globalSettingsButtons[i])\r\n        globalSettingsButtons[i].addEventListener('click', (e) => {\r\n          e.preventDefault()\r\n          this._modal.show()\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  _fireCookieEnvabledEvent () {\r\n    this._gdprCookiesEnabledEvt = new CustomEvent('gdprCookiesEnabled', {detail: this._gdprCookie.get()})\r\n    document.dispatchEvent(this._gdprCookiesEnabledEvt)\r\n  }\r\n\r\n  setEvent (evt, data) {\r\n    switch (evt) {\r\n      case 'accept_all_category':\r\n        this.acceptAllCategories()\r\n        break\r\n\r\n      case 'accept_categories':\r\n        this.acceptCategories(data.performance, data.analytics, data.marketing)\r\n        break\r\n\r\n      case 'show_modal':\r\n        this._modal.show()\r\n        break\r\n\r\n      default:\r\n        throw new Error('Event type not supported')\r\n    }\r\n  }\r\n\r\n  acceptAllCategories () {\r\n    this.acceptCategories(\r\n      !!this._opts.categories.performance,\r\n      !!this._opts.categories.analytics,\r\n      !!this._opts.categories.marketing,\r\n    )\r\n  }\r\n\r\n  //COOKIE =============================================================================================================\r\n\r\n  acceptCategories (isPerformanceAccepted, isAnalyticsAccepted, isMarketingAccepted) {\r\n    console.log('acceptCategories', isPerformanceAccepted, isAnalyticsAccepted, isMarketingAccepted)\r\n    // Load marketing scripts that only works when cookies are accepted\r\n    this._gdprCookie.set(\r\n      true,\r\n      isPerformanceAccepted,\r\n      isAnalyticsAccepted,\r\n      isMarketingAccepted\r\n    )\r\n    this._fireCookieEnvabledEvent()\r\n\r\n    if (this._gdprCookie.isExists() && this._gdprCookie.isNecessaryAccepted()) {\r\n      this._notice.hide()\r\n    } else {\r\n      this._notice.show()\r\n    }\r\n  }\r\n}\r\n\r\nexport default {GdprCookieNotice}"]}