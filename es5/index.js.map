{"version":3,"sources":["../src/index.js"],"names":["locales","GdprCookieNotice","options","_categories","categories","_locale","locale","_timeout","timeout","_domain","domain","window","location","hostname","_expiration","expiration","_isCategoriesCheckedByDefault","categoriesCheckedByDefault","_namespace","namespace","_pluginPrefix","pluginPrefix","_implicit","implicit","_cookiesAccepted","_gdprCookiesEnabledEvt","CustomEvent","detail","getCurrentCookieSelection","showNotice","buildNotice","setTimeout","document","documentElement","classList","add","console","log","getTemplateHtml","body","insertAdjacentHTML","settingsButton","querySelectorAll","acceptButton","addEventListener","e","preventDefault","acceptCookies","save","value","date","Date","necessary","i","templateKey","data","templateStr","template","Object","replace","j","Cookies","getJSON","isImplicit","isAccepted","isCategoriesCheckedByDefault"],"mappings":"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","file":"index.js","sourcesContent":["import { default as template } from './template'\r\nimport * as locales from './locales'\r\nimport Cookies from 'js-cookie'\r\nimport './sass/gdpr-cookie-notice.scss'\r\n\r\nclass GdprCookieNotice {\r\n  constructor (options) {\r\n    this._categories = options.categories ? options.categories : []\r\n    // this._categorySettings = []\r\n    this._locale = options.locale ? options.locale : 'hu'\r\n    this._timeout = options.timeout ? options.timeout : 500\r\n    this._domain = options.domain ? options.domain : window.location.hostname\r\n    this._expiration = options.expiration ? options.expiration : 30\r\n    this._isCategoriesCheckedByDefault = options.categoriesCheckedByDefault ? options.categoriesCheckedByDefault : false\r\n    this._namespace = options.namespace ? options.namespace : 'gdprcookienotice'\r\n    this._pluginPrefix = options.pluginPrefix ? options.pluginPrefix : 'gdpr-cookie-notice'\r\n    this._implicit = options.implicit ? options.implicit : false\r\n    this._cookiesAccepted = false\r\n\r\n    // if (options.performance && options.performance.length) {\r\n    //   this._categorySettings.performance = options.performance\r\n    //   this._categories.push('performance')\r\n    // }\r\n    //\r\n    // if (options.analytics && options.analytics.length) {\r\n    //   this._categorySettings.analytics = options.analytics\r\n    //   this._categories.push('analytics')\r\n    // }\r\n    //\r\n    // if (options.marketing && options.marketing.length) {\r\n    //   this._categorySettings.marketing = options.marketing\r\n    //   this._categories.push('marketing')\r\n    // }\r\n\r\n    // console.log('gdprCookieNotice', locales, locales.hu, template)\r\n    // console.log(this.getCurrentCookieSelection())\r\n\r\n    this._gdprCookiesEnabledEvt = new CustomEvent('gdprCookiesEnabled', {detail: this.getCurrentCookieSelection()})\r\n\r\n    if (!this.getCurrentCookieSelection()) {\r\n      this.showNotice()\r\n\r\n      // if (this._implicit) {\r\n      //   this.acceptOnScroll()\r\n      // }\r\n    }\r\n    // else {\r\n    //   this.deleteCookies(this.getCurrentCookieSelection())\r\n    //   document.dispatchEvent(this._gdprCookiesEnabledEvt)\r\n    // }\r\n\r\n  }\r\n\r\n  showNotice () {\r\n    this.buildNotice()\r\n\r\n    // Show the notice with a little timeout\r\n    window.setTimeout(() => {\r\n      document.documentElement.classList.add(this._pluginPrefix + '-loaded')\r\n    }, this._timeout)\r\n  }\r\n\r\n  buildNotice () {\r\n    console.log(this.getTemplateHtml('bar', locales[this._locale]))\r\n    document.body.insertAdjacentHTML('beforeend', this.getTemplateHtml('bar', locales[this._locale]))\r\n    let settingsButton = document.querySelectorAll('.' + this._pluginPrefix + '-nav-item-settings')[0]\r\n    let acceptButton = document.querySelectorAll('.' + this._pluginPrefix + '-nav-item-accept')[0]\r\n\r\n    settingsButton.addEventListener('click', (e) => {\r\n      e.preventDefault()\r\n      // showModal()\r\n    })\r\n\r\n    acceptButton.addEventListener('click', (e) => {\r\n      e.preventDefault()\r\n      this.acceptCookies()\r\n    })\r\n  }\r\n\r\n  acceptCookies (save) {\r\n    let value = {\r\n      date: new Date(),\r\n      necessary: true,\r\n    }\r\n\r\n    for (let i in this._categories) {\r\n      console.log(i, this._categories[i])\r\n    }\r\n\r\n    // categories.forEach(function (cat) {\r\n    //   value[cat] = true\r\n    // })\r\n    //\r\n    // // If request was coming from the modal, check for the settings\r\n    // if (save) {\r\n    //   for (var i = 0; i < categories.length; i++) {\r\n    //     value[categories[i]] = document.getElementById(pluginPrefix + '-cookie_' + categories[i]).checked\r\n    //   }\r\n    // }\r\n    //\r\n    // gdprCookies.set(namespace, value, {expires: config.expiration, domain: config.domain})\r\n    // deleteCookies(value)\r\n    //\r\n    // // Load marketing scripts that only works when cookies are accepted\r\n    // cookiesAcceptedEvent = new CustomEvent('gdprCookiesEnabled', {detail: value})\r\n    // document.dispatchEvent(cookiesAcceptedEvent)\r\n  }\r\n\r\n  getTemplateHtml (templateKey, data) {\r\n    let templateStr = template[templateKey]\r\n\r\n    // console.log('templateStr', templateStr, data)\r\n\r\n    if (typeof templateStr === 'string' && (data instanceof Object)) {\r\n      return templateStr.replace(/{{([^}]+)}}/g, function (i, j) {\r\n        if (data[j]) {\r\n          return data[j]\r\n        } else {\r\n          return i\r\n        }\r\n      })\r\n    } else {\r\n      return false\r\n    }\r\n  }\r\n\r\n  getCurrentCookieSelection () {\r\n    return Cookies.getJSON(this._namespace)\r\n  }\r\n\r\n  // deleteCookies (savedCookies) {\r\n  // let notAllEnabled = false\r\n  //\r\n  // for (let i = 0; i < this._categories.length; i++) {\r\n  //   if (config[categories[i]] && !savedCookies[categories[i]]) {\r\n  //     for (var ii = 0; ii < config[categories[i]].length; ii++) {\r\n  //       gdprCookies.remove(config[categories[i]][ii])\r\n  //       notAllEnabled = true\r\n  //     }\r\n  //   }\r\n  // }\r\n  // if (!savedCookies && !gdprCookies) {\r\n  //   showNotice()\r\n  // } else {\r\n  //   hideNotice()\r\n  // }\r\n  // }\r\n\r\n  // acceptOnScroll () {\r\n  //   window.addEventListener('scroll', function _listener () {\r\n  //     if (this.amountScrolled()) {\r\n  //       this.acceptCookies()\r\n  //       window.removeEventListener('click', _listener)\r\n  //     }\r\n  //   })\r\n  // }\r\n\r\n  // acceptCookies (save) {\r\n  //\r\n  // }\r\n\r\n  // amountScrolled () {\r\n  //   let winheight = window.innerHeight || (document.documentElement || document.body).clientHeight\r\n  //   let docheight = this.getDocHeight()\r\n  //   let scrollTop = window.pageYOffset || (document.documentElement || document.body.parentNode || document.body).scrollTop\r\n  //   let trackLength = docheight - winheight\r\n  //   let pctScrolled = Math.floor(scrollTop / trackLength * 100) // gets percentage scrolled (ie: 80 or NaN if tracklength == 0)\r\n  //   if (pctScrolled > 25 && !this._cookiesAccepted) {\r\n  //     this._cookiesAccepted = true\r\n  //     return true\r\n  //   } else {\r\n  //     return false\r\n  //   }\r\n  // }\r\n\r\n  // getDocHeight () {\r\n  //   return Math.max(\r\n  //     document.body.scrollHeight, document.documentElement.scrollHeight,\r\n  //     document.body.offsetHeight, document.documentElement.offsetHeight,\r\n  //     document.body.clientHeight, document.documentElement.clientHeight\r\n  //   )\r\n  // }\r\n\r\n  //GETTER - SETTER\r\n\r\n  set implicit (isImplicit) {\r\n    this._implicit = isImplicit\r\n  }\r\n\r\n  get implicit () {\r\n    return this._implicit\r\n  }\r\n\r\n  set cookiesAccepted (isAccepted) {\r\n    this._cookiesAccepted = isAccepted\r\n  }\r\n\r\n  get cookiesAccepted () {\r\n    return this._cookiesAccepted\r\n  }\r\n\r\n  set categories (categories) {\r\n    this._categories = categories\r\n  }\r\n\r\n  get categories () {\r\n    return this._categories\r\n  }\r\n\r\n  set locale (locale) {\r\n    this._locale = locale\r\n  }\r\n\r\n  get locale () {\r\n    return this._locale\r\n  }\r\n\r\n  set timeout (timeout) {\r\n    this._timeout = timeout\r\n  }\r\n\r\n  get timeout () {\r\n    return this._timeout\r\n  }\r\n\r\n  set domain (domain) {\r\n    this._domain = domain\r\n  }\r\n\r\n  get domain () {\r\n    return this._domain\r\n  }\r\n\r\n  set expiration (expiration) {\r\n    this._expiration = expiration\r\n  }\r\n\r\n  get expiration () {\r\n    return this._expiration\r\n  }\r\n\r\n  set isCategoriesCheckedByDefault (isCategoriesCheckedByDefault) {\r\n    this._isCategoriesCheckedByDefault = isCategoriesCheckedByDefault\r\n  }\r\n\r\n  get isCategoriesCheckedByDefault () {\r\n    return this._isCategoriesCheckedByDefault\r\n  }\r\n\r\n  set namespace (namespace) {\r\n    this._namespace = namespace\r\n  }\r\n\r\n  get namespace () {\r\n    return this._namespace\r\n  }\r\n\r\n  set pluginPrefix (pluginPrefix) {\r\n    this._pluginPrefix = pluginPrefix\r\n  }\r\n\r\n  get pluginPrefix () {\r\n    return this._pluginPrefix\r\n  }\r\n}\r\n\r\n// export default { gdprCookieNotice }\r\nexport default {GdprCookieNotice}"]}